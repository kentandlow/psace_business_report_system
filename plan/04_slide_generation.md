# 04. スライド生成モジュールの実装 (Step 4)

## 目標
Step 3 (`analyzer.py`) で生成した構造化データ（JSON等）から、最終成果物であるプレゼンテーションスライドデータを自動生成すること。

## 要件
- `src/generator.py` を作成すること。
- 生成したスライドファイルは `output/` ディレクトリに保存すること。ファイル名にはタイムスタンプを含めるとなお良い（例: `space_report_20241021.pptx`）。

## 実装方針の選択（Python 環境での推奨）
今回は Python による実装を前提としているため、**`python-pptx`** ライブラリを利用して PowerPoint (.pptx) ファイルを自動生成する方針を推奨する。

### 実装ステップ（python-pptx を使用する場合）
1. `from pptx import Presentation` で空のプレゼンテーションを作成する。
2. JSONで受け取った スライド配列データをループ処理する。
3. `prs.slides.add_slide(layout)` を用いて新しいスライドページを追加していく。
4. タイトル（`slide.shapes.title.text`）、本文の箇条書き（`tf = shape.text_frame`）などを設定。
5. 出典情報（URLやニュースサイト名）をフッターやサブテキストとして必ず表示させること。
6. `prs.save("output/weekly_report.pptx")` のように保存。

**（代替案: HTML形式スライド）**
もしWeb掲載を重視し、ブラウザで直接見られるHTMLスライドが良い場合は、`Marp` のような MarkdownベースのHTMLスライドジェネレータを利用する。
その場合は、Step 3 の出力を Marp 準拠の Markdown 形式にし、`subprocess` 経由で Marp ツール（CLI）を呼び出して HTML や PDF にコンパイルするロジックを組むこと。

## 見栄えについての配慮
- デフォルトの白紙テンプレートでも良いが、プロフェッショナルな印象を与える要素（シンプルで読みやすいフォントサイズの設定など）をコード側で定義しておくこと。
- 1スライドに文字を詰め込みすぎないよう、1枚あたりの箇条書きは4〜5点に収まるようStep 3のプロンプトと連携を取ること。
