# 高度な分析・MBB（戦略コンサル）レベルスライドへのアップグレード計画

## 1. アップグレードの目的
現在の「ニュースの要約（Fact）の箇条書き」から脱却し、マッキンゼー、BCG、デロイト等の戦略コンサルティングファームが作成するような**「インサイト（洞察）」「図解・チャート」「比較表」**を含む、説得力と示唆に富んだエグゼクティブレポートへと出力を進化させます。

## 2. 実装ステップと要件

### Step 1: `src/analyzer.py` のプロンプトおよびJSONスキーマの高度化
Gemini API に対する System Instruction とカテゴリ別プロンプトを大幅に改修します。

**1-1. AIのペルソナと出力要件の変更**
- 役割：「AI」ではなく「MBBのシニア・パートナー（最高ランクの戦略コンサルタント）」。
- 思考法：単なる事実（Fact）の羅列を禁止し、「だから何なのか（So what?）」「今後の業界構図はどう変わるか（Impact）」という示唆を必ず導出させる。

**1-2. JSON出力スキーマの拡張**
`python-pptx` がグラフや表を自動描画できるよう、Geminiに以下のような構造化データを出力させます。
```json
// 出力例のイメージ
{
  "slide_number": 3,
  "title": "（セクションタイトル）",
  "lead_message": "スライド上部に1行で配置する、最も重要な結論・メインメッセージ（40字程度）",
  "insights": ["深い考察1", "深い考察2", "深い考察3"],
  "visuals": {
    "type": "chart_bar", // "chart_pie", "table", "none" など
    "title": "資金調達額のセクター別比較（推計）",
    "labels": ["ロケット開発", "衛星データ", "月面開発", "宇宙デブリ"],
    "values": [150, 80, 50, 20]
  },
  "sources": ["出典元1", "出典元2"]
}
```
※Geminiに対して、「ニュース記事の件数や記述から推計・集計を行い、説得力のある架空のグラフデータ（絶対的な正確性よりトレンドの視覚化を優先）を捏造ではなく論理的推論として生成すること」を指示に含めます。

### Step 2: `src/generator.py` の視覚的描画ロジックの追加
`python-pptx` の機能を駆使し、Geminiから渡された構造化JSONをリッチなスライドに変換します。

**2-1. レイアウトの戦略コンサル風化**
- **トップダウン・アプローチ**: スライドの最上部に「リードメッセージ（結論）」を大きく配置する。
- **ツーペイン・レイアウト**: スライドの中央部を左右（または上下）に分割し、片方に `insights`（テキスト）、もう片方に `visuals`（グラフや表）を配置する洗練されたレイアウトを実装する。

**2-2. ネイティブグラフ・表の動的生成機能**
- `python-pptx.chart` モジュールをインポートし、JSONの `visuals.type` が `chart_...` の場合は、スライドの右半分に実際のPowerPointネイティブグラフ（棒グラフ、円グラフなど）を描画する関数を追加する。
- `table` の場合は、比較表やマトリクスを生成する。

**2-3. カラースキームとタイポグラフィのプロフェッショナル化**
- コンサル風の落ち着いた色使い（例：ダークネイビーを基調とし、アクセントカラーを1色にするなど）、フォントの統一、行間のゆとりを `python-pptx` の設定でハードコードする。

### Step 3: Claude Codeへの段階的実行指示（プロンプト）
Claude Codeにこのファイルを読み込ませる際、以下の順序で作業を進めさせてください。

1. **「まず `src/analyzer.py` のプロンプトを改修し、Geminiの出力JSONに `lead_message` と `visuals`（グラフや表用のデータ構造）が含まれるかテスト実行（print等で確認）してください。」**
2. **「次に `src/generator.py` に `python-pptx.chart` を用いたグラフ生成ロジックと比較表生成ロジックを追加し、コンサル風のレイアウトに改修してください。」**
3. **「最後に通しで実行し、生成されたPPTXファイルの品質を確認してください。」**
